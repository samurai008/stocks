(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(module,__webpack_exports__,__webpack_require__){"use strict";var _Users_Nilabjo_react_apps_my_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_Users_Nilabjo_react_apps_my_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_Users_Nilabjo_react_apps_my_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(5),_Users_Nilabjo_react_apps_my_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4),_Users_Nilabjo_react_apps_my_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6),events__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(11),events__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(events__WEBPACK_IMPORTED_MODULE_5__),_dispatcher_dispatcher__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(7),StockPriceStore=function(_EventEmitter){function StockPriceStore(){var e;return Object(_Users_Nilabjo_react_apps_my_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,StockPriceStore),(e=Object(_Users_Nilabjo_react_apps_my_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__.a)(this,Object(_Users_Nilabjo_react_apps_my_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__.a)(StockPriceStore).call(this))).stockDict={},e}return Object(_Users_Nilabjo_react_apps_my_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__.a)(StockPriceStore,_EventEmitter),Object(_Users_Nilabjo_react_apps_my_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(StockPriceStore,[{key:"reloadStocks",value:function reloadStocks(data){var _this2=this,stockData=eval(data);stockData.forEach(function(e){var t=null,a=[];e=e.concat((new Date).toString()),_this2.stockDict[e[0]]&&(a=_this2.stockDict[e[0]].pastPrices,t=_this2.stockDict[e[0]].price<e[1]),a.push(e[1]),_this2.stockDict[e[0]]={name:e[0],price:e[1],time:e[2],base:t,pastPrices:a}}),this.emit("stockChange")}},{key:"handleActions",value:function(e){switch(e.type){case"RELOAD_STOCKS":this.reloadStocks(e.stocks)}}},{key:"getAll",value:function(){return this.stockDict}}]),StockPriceStore}(events__WEBPACK_IMPORTED_MODULE_5__.EventEmitter),stockPriceStore=new StockPriceStore;_dispatcher_dispatcher__WEBPACK_IMPORTED_MODULE_6__.a.register(stockPriceStore.handleActions.bind(stockPriceStore)),__webpack_exports__.a=stockPriceStore},14:function(e,t,a){e.exports=a(30)},19:function(e,t,a){},23:function(e,t,a){},30:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),o=a(10),c=a.n(o),r=(a(19),a(2)),_=a(3),i=a(5),l=a(4),u=a(6),m=(a(23),a(1)),h=a(7);a(27),a(28);var d,p=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={data:null},a}return Object(u.a)(t,e),Object(_.a)(t,[{key:"componentWillMount",value:function(){var e=this;m.a.on("stockChange",function(){console.log("New batch of stocks!",m.a.getAll()[e.props.sKey]),e.setState({data:m.a.getAll()[e.props.sKey]})})}},{key:"render",value:function(){var e=this,t=n.a.createElement("div",null,"Nothing to display!");null!==this.state.data&&void 0!==this.state.data&&(console.log("enter",this.state.data),t=(this.state.data.pastPrices||[]).map(function(t,a){return console.log(e.props.data.base),n.a.createElement("li",{key:a,className:a===e.state.data.pastPrices.length-1?"font-weight-bold":"font-weight-light"},t," ",a===e.state.data.pastPrices.length-1?e.state.data.base?n.a.createElement("i",{className:"fas fa-arrow-up text-success"}):n.a.createElement("i",{className:"fas fa-arrow-down text-danger"}):"")}).reverse());return n.a.createElement("div",{style:{position:"fixed",top:"50%",left:"50%",width:"50%",transform:"translateX(-50%) translateY(-50%)",minHeight:"400px",maxHeight:"70%",overflowY:"scroll",zIndex:1},className:this.props.showModal?"bg-light p-2 container":"d-none"},n.a.createElement("div",{className:"d-flex justify-content-between"},n.a.createElement("div",null,n.a.createElement("h3",null,this.props.data.name)),n.a.createElement("div",null,n.a.createElement("button",{className:"btn",onClick:this.props.closeFn},"Close"))),n.a.createElement("ul",{className:"list-unstyled"},t))}}]),t}(s.Component),k=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={stocks:e.stocks,sortFn:function(){},stockModalFn:e.stockModalFn},a}return Object(u.a)(t,e),Object(_.a)(t,[{key:"sortByName",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"sortByPrice",value:function(e,t){return this[t].price-this[e].price}},{key:"sortByTime",value:function(e,t){return Date.parse(this[e].time)-Date.parse(this[t].time)>0?-1:Date.parse(this[e].time)-Date.parse(this[e].time)<0?1:0}},{key:"createStockTable",value:function(e){var t=this;return e?Object.keys(e).sort(this.state.sortFn.bind(e)).map(function(a,s){return n.a.createElement("tr",{"data-key":s,key:s},n.a.createElement("td",{className:"text-center"},n.a.createElement("a",{href:"#",onClick:function(s){return t.state.stockModalFn(e[a],a)},"data-name":a},e[a].name)),n.a.createElement("td",{className:e[a].base?"bg-success text-white text-center":null===e[a].base?"text-dark text-center":"bg-danger text-white text-center"},e[a].price.toFixed(2)),n.a.createElement("td",{className:"text-center"},e[a].time.slice(0,24)))}):n.a.createElement("tr",null,n.a.createElement("td",null,"Loading data"))}},{key:"render",value:function(){var e=this,t=this.createStockTable(this.state.stocks),a=n.a.createElement("tr",null,n.a.createElement("td",{className:"text-center text-info",colSpan:"3"},"Click open to load stream."));return n.a.createElement("div",null,n.a.createElement("table",{className:"table mt-2"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{className:"text-center"},n.a.createElement("a",{href:"#",onClick:function(t){return e.setState({sortFn:e.sortByName})}},"Name")),n.a.createElement("th",{className:"text-center"},n.a.createElement("a",{href:"#",onClick:function(t){return e.setState({sortFn:e.sortByPrice})}},"Price")),n.a.createElement("th",{className:"text-center"},n.a.createElement("a",{href:"#",onClick:function(t){return e.setState({sortFn:e.sortByTime})}},"Last Updated")))),n.a.createElement("tbody",null,0===Object.keys(this.state.stocks).length?a:t)))}}]),t}(s.Component);window.closeConnection=function(){return d.close()};var E=function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(i.a)(this,Object(l.a)(t).call(this))).state={stocks:m.a.getAll(),sortFn:function(){},mockPrices:["12.2","233.2","22.21","65.75"],stockModalData:{},showStockModal:!1,sKey:null},e}return Object(u.a)(t,e),Object(_.a)(t,[{key:"openConnection",value:function(){d=new WebSocket("wss://livestocks5.herokuapp.com"),this.getStockPrices()}},{key:"closeConnection",value:function(){d.close()}},{key:"getStockPrices",value:function(){d.onmessage=function(e){var t;t=e.data,h.a.dispatch({type:"RELOAD_STOCKS",stocks:t})}}},{key:"showStockModal",value:function(e,t){this.setState({stockModalData:e,showStockModal:!this.state.showStockModal,sKey:t})}},{key:"diffInfo",value:function(e){return e?"On the rise!":"On the low"}},{key:"closeModal",value:function(){this.setState({showStockModal:!this.state.showStockModal})}},{key:"componentWillMount",value:function(){var e=this;m.a.on("stockChange",function(){console.log("New batch of stocks!",m.a.getAll()),e.setState({stocks:m.a.getAll()})})}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",{className:"container p-2"},n.a.createElement("div",{className:"d-flex justify-content-between"},n.a.createElement("div",null,n.a.createElement("a",{href:"#",onClick:this.openConnection.bind(this)},"Open Stream")),n.a.createElement("div",null,n.a.createElement("a",{href:"#",onClick:this.closeConnection.bind(this)},"Close Stream"))),n.a.createElement(k,{stocks:this.state.stocks,stockModalFn:this.showStockModal.bind(this)})),n.a.createElement(p,{showModal:this.state.showStockModal,data:this.state.stockModalData,closeFn:this.closeModal.bind(this),sKey:this.state.sKey}),n.a.createElement("div",{style:{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.7)"},className:this.state.showStockModal?"":"d-none"}))}}]),t}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(n.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},7:function(e,t,a){"use strict";var s=a(12);t.a=new s.Dispatcher}},[[14,2,1]]]);
//# sourceMappingURL=main.80b1bba5.chunk.js.map